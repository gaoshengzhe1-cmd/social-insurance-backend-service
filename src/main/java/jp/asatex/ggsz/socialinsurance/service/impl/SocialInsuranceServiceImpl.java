package jp.asatex.ggsz.socialinsurance.service.impl;

import jp.asatex.ggsz.socialinsurance.dto.SocialInsuranceDomainDto;
import jp.asatex.ggsz.socialinsurance.entity.PremiumBracket;
import jp.asatex.ggsz.socialinsurance.repository.PremiumBracketRepository;
import jp.asatex.ggsz.socialinsurance.service.SocialInsuranceService;
import lombok.RequiredArgsConstructor;
import lombok.extern.slf4j.Slf4j;
import org.springframework.stereotype.Service;
import reactor.core.publisher.Mono;

import java.math.BigDecimal;
import java.math.RoundingMode;

/**
 * 社会保险领域服务实现类
 */
@Slf4j
@Service
@RequiredArgsConstructor
public class SocialInsuranceServiceImpl implements SocialInsuranceService {

    private static final int CARE_INSURANCE_AGE_THRESHOLD = 40;
    private static final BigDecimal EMPLOYMENT_RATE_GENERAL = new BigDecimal("0.0055");
    private final PremiumBracketRepository premiumBracketRepository;

    @Override
    public Mono<SocialInsuranceDomainDto> socialInsuranceQuery(Integer monthlySalary, Integer age) {
        return premiumBracketRepository.findBracketByAmount(monthlySalary)
                .switchIfEmpty(Mono.error(new IllegalArgumentException("No matching premium bracket found for the given salary")))
                .flatMap(bracket -> calculateInsuranceCosts(bracket, age, monthlySalary));
    }

    private Mono<SocialInsuranceDomainDto> calculateInsuranceCosts(PremiumBracket bracket, Integer age, Integer monthlySalary) {
        return Mono.fromCallable(() -> {
            // 计算无介护健康保险金额（每月）: 直接使用表中的月额
            BigDecimal totalHealthCostWithNoCare = bracket.getHealthNoCare();

            // 计算厚生年金金额（每月）: 直接使用表中的月额
            BigDecimal totalPension = bracket.getPension();

            // 计算介护保险金额（每月）: 有介护健康保险 - 无介护健康保险
            BigDecimal totalCareCost = BigDecimal.ZERO;
            if (age >= CARE_INSURANCE_AGE_THRESHOLD) {
                totalCareCost = bracket.getHealthCare()
                        .subtract(bracket.getHealthNoCare());
            }

            // 雇员负担：健康保险、厚生年金按 50% 分摊
            BigDecimal employeeHealth = totalHealthCostWithNoCare
                    .divide(new BigDecimal(2), 0, RoundingMode.HALF_UP);
            BigDecimal employeePension = totalPension
                    .divide(new BigDecimal(2), 0, RoundingMode.HALF_UP);

            // 雇员负担：雇用保险（一般被保険者”);
            BigDecimal employeeEmployment = roundSpecial(
                    BigDecimal.valueOf(monthlySalary).multiply(EMPLOYMENT_RATE_GENERAL)
            );

            BigDecimal socialInsuranceTotal = employeeHealth
                    .add(employeePension)
                    .add(employeeEmployment);

            BigDecimal taxableIncomeForTax = BigDecimal.valueOf(monthlySalary)
                    .subtract(socialInsuranceTotal);
            if (taxableIncomeForTax.compareTo(BigDecimal.ZERO) < 0) {
                taxableIncomeForTax = BigDecimal.ZERO;
            }

            int incomeTaxAmountInt = getTaxFromTable(taxableIncomeForTax.intValue(), 0);
            BigDecimal incomeTaxAmount = BigDecimal.valueOf(incomeTaxAmountInt);

            // 使用工厂方法，根据总额创建雇员/雇主分摊后的 DTO
            SocialInsuranceDomainDto dto = SocialInsuranceDomainDto.createWithSharedCosts(
                    totalHealthCostWithNoCare,
                    totalCareCost,
                    totalPension
            );
            if (dto.getEmployeeCost() != null) {
                dto.getEmployeeCost().setHealthCostWithNoCare(employeeHealth);
                dto.getEmployeeCost().setPension(employeePension);
                dto.getEmployeeCost().setEmploymentInsurance(employeeEmployment);
                dto.getEmployeeCost().setIncomeTax(incomeTaxAmount);
            }
            return dto;
        });
    }

    private BigDecimal roundSpecial(BigDecimal amount) {
        BigDecimal floor = amount.setScale(0, RoundingMode.FLOOR);
        BigDecimal fraction = amount.subtract(floor);
        if (fraction.compareTo(new BigDecimal("0.50000001")) > 0) {
            return floor.add(BigDecimal.ONE);
        }
        return floor;
    }

    private int getTaxFromTable(int taxableIncome, int dependents) {
        int cappedDependents = Math.min(dependents, 7);

        if (taxableIncome < 88000) {
            return 0;
        }

        if (taxableIncome >= 740000 && taxableIncome < 780000) {
            int[] baseRow = {73390, 66920, 60450, 53980, 47520, 41050, 34580, 28120};
            int baseTax = baseRow[cappedDependents];
            int excess = taxableIncome - 740000;
            return Math.max(0, (int) Math.floor(baseTax + (excess * 0.2042)));
        }

        if (taxableIncome >= 780000 && taxableIncome < 950000) {
            int[] baseRow = {81560, 75090, 68620, 62150, 55690, 49220, 42750, 36290};
            int baseTax = baseRow[cappedDependents];
            int excess = taxableIncome - 780000;
            return Math.max(0, (int) Math.floor(baseTax + (excess * 0.23483)));
        }

        if (taxableIncome >= 950000 && taxableIncome < 1700000) {
            int[] baseRow = {121480, 115010, 108540, 102070, 95610, 89140, 82670, 76210};
            int baseTax = baseRow[cappedDependents];
            int excess = taxableIncome - 950000;
            return Math.max(0, (int) Math.floor(baseTax + (excess * 0.33693)));
        }

        if (taxableIncome >= 1700000 && taxableIncome < 2170000) {
            int[] baseRow = {374180, 367710, 361240, 354770, 348310, 341840, 335370, 328910};
            int baseTax = baseRow[cappedDependents];
            int excess = taxableIncome - 1700000;
            return Math.max(0, (int) Math.floor(baseTax + (excess * 0.4084)));
        }

        if (taxableIncome >= 2170000 && taxableIncome < 2210000) {
            int[] baseRow = {571570, 565090, 558630, 552160, 545690, 539230, 532760, 526290};
            int baseTax = baseRow[cappedDependents];
            int excess = taxableIncome - 2170000;
            return Math.max(0, (int) Math.floor(baseTax + (excess * 0.4084)));
        }

        if (taxableIncome >= 2210000 && taxableIncome < 2250000) {
            int[] baseRow = {593340, 586870, 580410, 573930, 567470, 561010, 554540, 548070};
            int baseTax = baseRow[cappedDependents];
            int excess = taxableIncome - 2210000;
            return Math.max(0, (int) Math.floor(baseTax + (excess * 0.4084)));
        }

        if (taxableIncome >= 2250000 && taxableIncome < 3500000) {
            int[] baseRow = {615120, 608650, 602190, 595710, 589250, 582790, 576310, 569850};
            int baseTax = baseRow[cappedDependents];
            int excess = taxableIncome - 2250000;
            return Math.max(0, (int) Math.floor(baseTax + (excess * 0.4084)));
        }

        if (taxableIncome >= 3500000) {
            int[] baseRow = {1125620, 1119150, 1112690, 1106210, 1099750, 1093290, 1086810, 1080350};
            int baseTax = baseRow[cappedDependents];
            int excess = taxableIncome - 3500000;
            return Math.max(0, (int) Math.floor(baseTax + (excess * 0.45945)));
        }

        return calculateComputerTax(taxableIncome, dependents);
    }

    private int calculateComputerTax(int salary, int dependents) {
        // First try to find in the table
        for (int[] row : SAMPLE_TABLE) {
            if (salary >= row[0] && salary < row[1]) {
                int index = Math.min(dependents, 7) + 2;
                return row[index];
            }
        }

        // For high incomes, use the formula from taxData.ts
        if (salary >= 740000 && salary < 780000) {
            int[] baseRow = {73390, 66920, 60450, 53980, 47520, 41050, 34580, 28120};
            int baseTax = baseRow[Math.min(dependents, 7)];
            int excess = salary - 740000;
            return Math.max(0, (int) Math.floor(baseTax + (excess * 0.2042)));
        }
        if (salary >= 780000 && salary < 950000) {
            int[] baseRow = {81560, 75090, 68620, 62150, 55690, 49220, 42750, 36290};
            int baseTax = baseRow[Math.min(dependents, 7)];
            int excess = salary - 780000;
            return Math.max(0, (int) Math.floor(baseTax + (excess * 0.23483)));
        }
        // Add more high-income brackets as needed...

        // Fallback to estimation if not in any range
        double estimatedTax;
        if (salary < 170000) {
            estimatedTax = (salary - 88000) * 0.05105;
        } else {
            estimatedTax = salary * 0.035 - 3000 - (dependents * 2500);
        }

        return Math.max(0, (int) Math.floor(estimatedTax));
    }

    private static final int[][] SAMPLE_TABLE = new int[][]{
            {88000, 89000, 130, 0, 0, 0, 0, 0, 0, 0},
            {89000, 90000, 180, 0, 0, 0, 0, 0, 0, 0},
            {90000, 91000, 230, 0, 0, 0, 0, 0, 0, 0},
            {91000, 92000, 290, 0, 0, 0, 0, 0, 0, 0},
            {92000, 93000, 340, 0, 0, 0, 0, 0, 0, 0},
            {93000, 94000, 390, 0, 0, 0, 0, 0, 0, 0},
            {94000, 95000, 440, 0, 0, 0, 0, 0, 0, 0},
            {95000, 96000, 490, 0, 0, 0, 0, 0, 0, 0},
            {96000, 97000, 540, 0, 0, 0, 0, 0, 0, 0},
            {97000, 98000, 590, 0, 0, 0, 0, 0, 0, 0},
            {98000, 99000, 640, 0, 0, 0, 0, 0, 0, 0},
            {99000, 101000, 720, 0, 0, 0, 0, 0, 0, 0},
            {101000, 103000, 830, 0, 0, 0, 0, 0, 0, 0},
            {103000, 105000, 930, 0, 0, 0, 0, 0, 0, 0},
            {105000, 107000, 1030, 0, 0, 0, 0, 0, 0, 0},
            {107000, 109000, 1130, 0, 0, 0, 0, 0, 0, 0},
            {109000, 111000, 1240, 0, 0, 0, 0, 0, 0, 0},
            {111000, 113000, 1340, 0, 0, 0, 0, 0, 0, 0},
            {113000, 115000, 1440, 0, 0, 0, 0, 0, 0, 0},
            {115000, 117000, 1540, 0, 0, 0, 0, 0, 0, 0},
            {117000, 119000, 1640, 0, 0, 0, 0, 0, 0, 0},
            {119000, 121000, 1750, 120, 0, 0, 0, 0, 0, 0},
            {121000, 123000, 1850, 220, 0, 0, 0, 0, 0, 0},
            {123000, 125000, 1950, 330, 0, 0, 0, 0, 0, 0},
            {125000, 127000, 2050, 430, 0, 0, 0, 0, 0, 0},
            {127000, 129000, 2150, 530, 0, 0, 0, 0, 0, 0},
            {129000, 131000, 2260, 630, 0, 0, 0, 0, 0, 0},
            {131000, 133000, 2360, 740, 0, 0, 0, 0, 0, 0},
            {133000, 135000, 2460, 840, 0, 0, 0, 0, 0, 0},
            {135000, 137000, 2550, 930, 0, 0, 0, 0, 0, 0},
            {137000, 139000, 2610, 990, 0, 0, 0, 0, 0, 0},
            {139000, 141000, 2680, 1050, 0, 0, 0, 0, 0, 0},
            {141000, 143000, 2740, 1110, 0, 0, 0, 0, 0, 0},
            {143000, 145000, 2800, 1170, 0, 0, 0, 0, 0, 0},
            {145000, 147000, 2860, 1240, 0, 0, 0, 0, 0, 0},
            {147000, 149000, 2920, 1300, 0, 0, 0, 0, 0, 0},
            {149000, 151000, 2980, 1360, 0, 0, 0, 0, 0, 0},
            {151000, 153000, 3050, 1430, 0, 0, 0, 0, 0, 0},
            {153000, 155000, 3120, 1500, 0, 0, 0, 0, 0, 0},
            {155000, 157000, 3200, 1570, 0, 0, 0, 0, 0, 0},
            {157000, 159000, 3270, 1640, 0, 0, 0, 0, 0, 0},
            {159000, 161000, 3340, 1720, 100, 0, 0, 0, 0, 0},
            {161000, 163000, 3410, 1790, 170, 0, 0, 0, 0, 0},
            {163000, 165000, 3480, 1860, 250, 0, 0, 0, 0, 0},
            {165000, 167000, 3550, 1930, 320, 0, 0, 0, 0, 0},
            {167000, 170000, 3630, 2010, 400, 0, 0, 0, 0, 0},
            {170000, 173000, 3720, 2090, 480, 0, 0, 0, 0, 0},
            {173000, 176000, 3800, 2170, 550, 0, 0, 0, 0, 0},
            {176000, 179000, 3880, 2250, 630, 0, 0, 0, 0, 0},
            {179000, 182000, 3960, 2330, 700, 0, 0, 0, 0, 0},
            {182000, 185000, 4040, 2410, 780, 0, 0, 0, 0, 0},
            {185000, 188000, 4120, 2490, 850, 0, 0, 0, 0, 0},
            {188000, 191000, 4200, 2570, 930, 0, 0, 0, 0, 0},
            {191000, 194000, 4280, 2650, 1000, 0, 0, 0, 0, 0},
            {194000, 197000, 4360, 2730, 1080, 0, 0, 0, 0, 0},
            {197000, 200000, 4440, 2810, 1160, 0, 0, 0, 0, 0},
            {200000, 203000, 4530, 2890, 1240, 0, 0, 0, 0, 0},
            {203000, 206000, 4620, 2980, 1320, 0, 0, 0, 0, 0},
            {206000, 209000, 4710, 3070, 1400, 0, 0, 0, 0, 0},
            {209000, 212000, 4800, 3160, 1480, 0, 0, 0, 0, 0},
            {212000, 215000, 4890, 3250, 1560, 0, 0, 0, 0, 0},
            {215000, 218000, 4980, 3340, 1640, 0, 0, 0, 0, 0},
            {218000, 221000, 5070, 3430, 1720, 0, 0, 0, 0, 0},
            {221000, 224000, 5160, 3520, 1800, 0, 0, 0, 0, 0},
            {224000, 227000, 5250, 3610, 1880, 0, 0, 0, 0, 0},
            {227000, 230000, 5340, 3700, 1960, 0, 0, 0, 0, 0},
            {230000, 233000, 5430, 3790, 2040, 0, 0, 0, 0, 0},
            {233000, 236000, 5520, 3880, 2120, 0, 0, 0, 0, 0},
            {236000, 239000, 5610, 3970, 2200, 0, 0, 0, 0, 0},
            {239000, 242000, 5700, 4060, 2280, 0, 0, 0, 0, 0},
            {242000, 245000, 5790, 4150, 2360, 0, 0, 0, 0, 0},
            {245000, 248000, 5880, 4240, 2440, 0, 0, 0, 0, 0},
            {248000, 251000, 5970, 4330, 2520, 0, 0, 0, 0, 0},
            {251000, 254000, 6060, 4420, 2600, 0, 0, 0, 0, 0},
            {254000, 257000, 6150, 4510, 2680, 0, 0, 0, 0, 0},
            {257000, 260000, 6240, 4600, 2760, 0, 0, 0, 0, 0},
            {260000, 263000, 6330, 4690, 2840, 0, 0, 0, 0, 0},
            {263000, 266000, 6420, 4780, 2920, 0, 0, 0, 0, 0},
            {266000, 269000, 6510, 4870, 3000, 0, 0, 0, 0, 0},
            {269000, 272000, 6600, 4960, 3080, 0, 0, 0, 0, 0},
            {272000, 275000, 6690, 5050, 3160, 0, 0, 0, 0, 0},
            {275000, 278000, 6780, 5140, 3240, 0, 0, 0, 0, 0},
            {278000, 281000, 6870, 5230, 3320, 0, 0, 0, 0, 0},
            {281000, 284000, 6960, 5320, 3400, 0, 0, 0, 0, 0},
            {284000, 287000, 7050, 5410, 3480, 0, 0, 0, 0, 0},
            {287000, 290000, 7140, 5500, 3560, 0, 0, 0, 0, 0},
            {290000, 293000, 7230, 5590, 3640, 0, 0, 0, 0, 0},
            {293000, 296000, 7320, 5680, 3720, 0, 0, 0, 0, 0},
            {296000, 299000, 7410, 5770, 3800, 0, 0, 0, 0, 0},
            {299000, 302000, 7500, 5860, 3880, 0, 0, 0, 0, 0},
            {302000, 305000, 7590, 5950, 3960, 0, 0, 0, 0, 0},
            {305000, 308000, 7680, 6040, 4040, 0, 0, 0, 0, 0},
            {308000, 311000, 7770, 6130, 4120, 0, 0, 0, 0, 0},
            {311000, 314000, 7860, 6220, 4200, 0, 0, 0, 0, 0},
            {314000, 317000, 7950, 6310, 4280, 0, 0, 0, 0, 0},
            {317000, 320000, 8040, 6400, 4360, 0, 0, 0, 0, 0},
            {320000, 323000, 8130, 6490, 4440, 0, 0, 0, 0, 0},
            {323000, 326000, 8220, 6580, 4520, 0, 0, 0, 0, 0},
            {326000, 329000, 8310, 6670, 4600, 0, 0, 0, 0, 0},
            {329000, 332000, 8400, 6760, 4680, 0, 0, 0, 0, 0},
            {332000, 335000, 8490, 6850, 4760, 0, 0, 0, 0, 0},
            {335000, 338000, 8580, 6940, 4840, 0, 0, 0, 0, 0},
            {338000, 341000, 8670, 7030, 4920, 0, 0, 0, 0, 0},
            {341000, 344000, 8760, 7120, 5000, 0, 0, 0, 0, 0},
            {344000, 347000, 8850, 7210, 5080, 0, 0, 0, 0, 0},
            {347000, 350000, 8940, 7300, 5160, 0, 0, 0, 0, 0},
            {350000, 353000, 9030, 7390, 5240, 0, 0, 0, 0, 0},
            {353000, 356000, 9120, 7480, 5320, 0, 0, 0, 0, 0},
            {356000, 359000, 9210, 7570, 5400, 0, 0, 0, 0, 0},
            {359000, 362000, 9300, 7660, 5480, 0, 0, 0, 0, 0},
            {362000, 365000, 9390, 7750, 5560, 0, 0, 0, 0, 0},
            {365000, 368000, 9480, 7840, 5640, 0, 0, 0, 0, 0},
            {368000, 371000, 9570, 7930, 5720, 0, 0, 0, 0, 0},
            {371000, 374000, 9660, 8020, 5800, 0, 0, 0, 0, 0},
            {374000, 377000, 9750, 8110, 5880, 0, 0, 0, 0, 0},
            {377000, 380000, 9840, 8200, 5960, 0, 0, 0, 0, 0},
            {380000, 383000, 9930, 8290, 6040, 0, 0, 0, 0, 0},
            {383000, 386000, 10020, 8380, 6120, 0, 0, 0, 0, 0},
            {386000, 389000, 10110, 8470, 6200, 0, 0, 0, 0, 0},
            {389000, 392000, 10200, 8560, 6280, 0, 0, 0, 0, 0},
            {392000, 395000, 10290, 8650, 6360, 0, 0, 0, 0, 0},
            {395000, 398000, 10380, 8740, 6440, 0, 0, 0, 0, 0},
            {398000, 401000, 10470, 8830, 6520, 0, 0, 0, 0, 0},
            {401000, 404000, 10560, 8920, 6600, 0, 0, 0, 0, 0},
            {404000, 407000, 10650, 9010, 6680, 0, 0, 0, 0, 0},
            {407000, 410000, 10740, 9100, 6760, 0, 0, 0, 0, 0},
            {410000, 413000, 10830, 9190, 6840, 0, 0, 0, 0, 0},
            {413000, 416000, 10920, 9280, 6920, 0, 0, 0, 0, 0},
            {416000, 419000, 11010, 9370, 7000, 0, 0, 0, 0, 0},
            {419000, 422000, 11100, 9460, 7080, 0, 0, 0, 0, 0},
            {422000, 425000, 11190, 9550, 7160, 0, 0, 0, 0, 0},
            {425000, 428000, 11280, 9640, 7240, 0, 0, 0, 0, 0},
            {428000, 431000, 11370, 9730, 7320, 0, 0, 0, 0, 0},
            {431000, 434000, 11460, 9820, 7400, 0, 0, 0, 0, 0},
            {434000, 437000, 11550, 9910, 7480, 0, 0, 0, 0, 0},
            {437000, 440000, 11640, 10000, 7560, 0, 0, 0, 0, 0},
            {440000, 443000, 11730, 10090, 7640, 0, 0, 0, 0, 0},
            {443000, 446000, 11820, 10180, 7720, 0, 0, 0, 0, 0},
            {446000, 449000, 11910, 10270, 7800, 0, 0, 0, 0, 0},
            {449000, 452000, 12000, 10360, 7880, 0, 0, 0, 0, 0},
            {452000, 455000, 12090, 10450, 7960, 0, 0, 0, 0, 0},
            {455000, 458000, 12180, 10540, 8040, 0, 0, 0, 0, 0},
            {458000, 461000, 12270, 10630, 8120, 0, 0, 0, 0, 0},
            {461000, 464000, 12360, 10720, 8200, 0, 0, 0, 0, 0},
            {464000, 467000, 12450, 10810, 8280, 0, 0, 0, 0, 0},
            {467000, 470000, 12540, 10900, 8360, 0, 0, 0, 0, 0},
            {470000, 473000, 12630, 10990, 8440, 0, 0, 0, 0, 0},
            {473000, 476000, 12720, 11080, 8520, 0, 0, 0, 0, 0},
            {476000, 479000, 12810, 11170, 8600, 0, 0, 0, 0, 0},
            {479000, 482000, 12900, 11260, 8680, 0, 0, 0, 0, 0},
            {482000, 485000, 12990, 11350, 8760, 0, 0, 0, 0, 0},
            {485000, 488000, 13080, 11440, 8840, 0, 0, 0, 0, 0},
            {488000, 491000, 13170, 11530, 8920, 0, 0, 0, 0, 0},
            {491000, 494000, 13260, 11620, 9000, 0, 0, 0, 0, 0},
            {494000, 497000, 13350, 11710, 9080, 0, 0, 0, 0, 0},
            {497000, 500000, 13440, 11800, 9160, 0, 0, 0, 0, 0},
            {500000, 503000, 13530, 11890, 9240, 0, 0, 0, 0, 0},
            {503000, 506000, 13620, 11980, 9320, 0, 0, 0, 0, 0},
            {506000, 509000, 13710, 12070, 9400, 0, 0, 0, 0, 0},
            {509000, 512000, 13800, 12160, 9480, 0, 0, 0, 0, 0},
            {512000, 515000, 13890, 12250, 9560, 0, 0, 0, 0, 0},
            {515000, 518000, 13980, 12340, 9640, 0, 0, 0, 0, 0},
            {518000, 521000, 14070, 12430, 9720, 0, 0, 0, 0, 0},
            {521000, 524000, 14160, 12520, 9800, 0, 0, 0, 0, 0},
            {524000, 527000, 14250, 12610, 9880, 0, 0, 0, 0, 0},
            {527000, 530000, 14340, 12700, 9960, 0, 0, 0, 0, 0},
            {530000, 533000, 14430, 12790, 10040, 0, 0, 0, 0, 0},
            {533000, 536000, 14520, 12880, 10120, 0, 0, 0, 0, 0},
            {536000, 539000, 14610, 12970, 10200, 0, 0, 0, 0, 0},
            {539000, 542000, 14700, 13060, 10280, 0, 0, 0, 0, 0},
            {542000, 545000, 14790, 13150, 10360, 0, 0, 0, 0, 0},
            {545000, 548000, 14880, 13240, 10440, 0, 0, 0, 0, 0},
            {548000, 551000, 14970, 13330, 10520, 0, 0, 0, 0, 0},
            {551000, 554000, 15060, 13420, 10600, 0, 0, 0, 0, 0},
            {554000, 557000, 15150, 13510, 10680, 0, 0, 0, 0, 0},
            {557000, 560000, 15240, 13600, 10760, 0, 0, 0, 0, 0},
            {560000, 563000, 15330, 13690, 10840, 0, 0, 0, 0, 0},
            {563000, 566000, 15420, 13780, 10920, 0, 0, 0, 0, 0},
            {566000, 569000, 15510, 13870, 11000, 0, 0, 0, 0, 0},
            {569000, 572000, 15600, 13960, 11080, 0, 0, 0, 0, 0},
            {572000, 575000, 15690, 14050, 11160, 0, 0, 0, 0, 0},
            {575000, 578000, 15780, 14140, 11240, 0, 0, 0, 0, 0},
            {578000, 581000, 15870, 14230, 11320, 0, 0, 0, 0, 0},
            {581000, 584000, 15960, 14320, 11400, 0, 0, 0, 0, 0},
            {584000, 587000, 16050, 14410, 11480, 0, 0, 0, 0, 0},
            {587000, 590000, 16140, 14500, 11560, 0, 0, 0, 0, 0},
            {590000, 593000, 16230, 14590, 11640, 0, 0, 0, 0, 0},
            {593000, 596000, 16320, 14680, 11720, 0, 0, 0, 0, 0},
            {596000, 599000, 16410, 14770, 11800, 0, 0, 0, 0, 0},
            {599000, 602000, 16500, 14860, 11880, 0, 0, 0, 0, 0},
            {602000, 605000, 16590, 14950, 11960, 0, 0, 0, 0, 0},
            {605000, 608000, 16680, 15040, 12040, 0, 0, 0, 0, 0},
            {608000, 611000, 16770, 15130, 12120, 0, 0, 0, 0, 0},
            {611000, 614000, 16860, 15220, 12200, 0, 0, 0, 0, 0},
            {614000, 617000, 16950, 15310, 12280, 0, 0, 0, 0, 0},
            {617000, 620000, 17040, 15400, 12360, 0, 0, 0, 0, 0},
            {620000, 623000, 17130, 15490, 12440, 0, 0, 0, 0, 0},
            {623000, 626000, 17220, 15580, 12520, 0, 0, 0, 0, 0},
            {626000, 629000, 17310, 15670, 12600, 0, 0, 0, 0, 0},
            {629000, 632000, 17400, 15760, 12680, 0, 0, 0, 0, 0},
            {632000, 635000, 17490, 15850, 12760, 0, 0, 0, 0, 0},
            {635000, 638000, 17580, 15940, 12840, 0, 0, 0, 0, 0},
            {638000, 641000, 17670, 16030, 12920, 0, 0, 0, 0, 0},
            {641000, 644000, 17760, 16120, 13000, 0, 0, 0, 0, 0},
            {644000, 647000, 17850, 16210, 13080, 0, 0, 0, 0, 0},
            {647000, 650000, 17940, 16300, 13160, 0, 0, 0, 0, 0},
            {650000, 653000, 18030, 16390, 13240, 0, 0, 0, 0, 0},
            {653000, 656000, 18120, 16480, 13320, 0, 0, 0, 0, 0},
            {656000, 659000, 18210, 16570, 13400, 0, 0, 0, 0, 0},
            {659000, 662000, 18300, 16660, 13480, 0, 0, 0, 0, 0},
            {662000, 665000, 18390, 16750, 13560, 0, 0, 0, 0, 0},
            {665000, 668000, 18480, 16840, 13640, 0, 0, 0, 0, 0},
            {668000, 671000, 18570, 16930, 13720, 0, 0, 0, 0, 0},
            {671000, 674000, 18660, 17020, 13800, 0, 0, 0, 0, 0},
            {674000, 677000, 18750, 17110, 13880, 0, 0, 0, 0, 0},
            {677000, 680000, 18840, 17200, 13960, 0, 0, 0, 0, 0},
            {680000, 683000, 18930, 17290, 14040, 0, 0, 0, 0, 0},
            {683000, 686000, 19020, 17380, 14120, 0, 0, 0, 0, 0},
            {686000, 689000, 19110, 17470, 14200, 0, 0, 0, 0, 0},
            {689000, 692000, 19200, 17560, 14280, 0, 0, 0, 0, 0},
            {692000, 695000, 19290, 17650, 14360, 0, 0, 0, 0, 0},
            {695000, 698000, 19380, 17740, 14440, 0, 0, 0, 0, 0},
            {698000, 701000, 19470, 17830, 14520, 0, 0, 0, 0, 0},
            {701000, 704000, 19560, 17920, 14600, 0, 0, 0, 0, 0},
            {704000, 707000, 19650, 18010, 14680, 0, 0, 0, 0, 0},
            {707000, 710000, 19740, 18100, 14760, 0, 0, 0, 0, 0},
            {710000, 713000, 19830, 18190, 14840, 0, 0, 0, 0, 0},
            {713000, 716000, 19920, 18280, 14920, 0, 0, 0, 0, 0},
            {716000, 719000, 20010, 18370, 15000, 0, 0, 0, 0, 0},
            {719000, 722000, 20100, 18460, 15080, 0, 0, 0, 0, 0},
            {722000, 725000, 20190, 18550, 15160, 0, 0, 0, 0, 0},
            {725000, 728000, 20280, 18640, 15240, 0, 0, 0, 0, 0},
            {728000, 731000, 20370, 18730, 15320, 0, 0, 0, 0, 0},
            {731000, 734000, 20460, 18820, 15400, 0, 0, 0, 0, 0},
            {734000, 737000, 20550, 18910, 15480, 0, 0, 0, 0, 0},
            {737000, 740000, 20640, 19000, 15560, 0, 0, 0, 0, 0}
    };
}
